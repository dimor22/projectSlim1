{% extends "admin/admin_base.html.twig" %}

{% block title %}Testimonials{% endblock %}

{% block content_header %}
    <h1>
        Appointments
        <small>All Appointments</small>
    </h1>
{% endblock content_header %}

{% block content %}
    <!-- Main content -->
    <section class="content">

        {% include 'admin/modals/delete_appt.twig' %}
        {% include 'admin/modals/done_appt.twig' %}


        <div class="row">
            <div class="col-lg-3 col-xs-6">
                <!-- small box -->
                <div class="small-box bg-green">
                    <div class="inner">
                        <h3 id="done-appts"></h3>
                        <p>Appointments Completed</p>
                    </div>
                    <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-xs-6">
                <!-- small box -->
                <div class="small-box bg-yellow">
                    <div class="inner">
                        <h3 id="new-appts"></h3>
                        <p>New Appointments</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                </div>
            </div>

        </div>


        <hr />
        <div class="row">
            <div class="col-md-12">
                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title">All Appointments -
                            <button class="btn btn-default btn-flat btn-sm" id="show-completed">Show Completed</button>
                            <button class="btn btn-default btn-flat btn-sm" id="hide-completed">Hide Completed</button></h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body table-responsive no-padding">
                        <table class="table table-hover">
                            <tbody><tr>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Product</th>
                                <th>Name</th>
                                <th>Address</th>
                                <th>City</th>
                                <th>State</th>
                                <th>Zip</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Created</th>
                                <th>Action</th>
                            </tr>
                            {% for appt in appts %}
                                <tr>
                                    <td>{{ appt.date }}</td>
                                    <td>{{ appt.time }}</td>
                                    <td>{{ appt.product }}</td>
                                    <td>{{ appt.name }}</td>
                                    <td>{{ appt.address }}</td>
                                    <td>{{ appt.city }}</td>
                                    <td>{{ appt.state }}</td>
                                    <td>{{ appt.zip }}</td>
                                    <td>{{ appt.phone }}</td>
                                    <td>{{ appt.email }}</td>
                                    <td>{{ appt.created_at }}</td>
                                    {% if appt.completed_at == "0000-00-00 00:00:00" %}
                                        <td class="new-appt"><button class="btn btn-warning btn-flat btn-sm done-appt-btn" data-toggle="modal" data-target="#done-appt" id="{{ appt.id }}">New</button></td>
                                    {% else %}
                                        <td class="done-appt"><button class="btn btn-success btn-flat btn-sm" id="{{ appt.id }}">Done</button></td>
                                    {% endif %}
                                        <td class="delete-appt"><button class="btn btn-danger btn-flat btn-sm delete-appt-btn" data-toggle="modal" data-target="#delete-appt"  id="{{ appt.id }}">Delete</button></td>
                                </tr>
                            {% endfor %}

                            </tbody>
                        </table>
                    </div>
                    <!-- /.box-body -->
                </div>
            </div>
        </div>

    </section>
    <!-- /.content -->
{% endblock content %}

{% block js %}
<script>

    // delete testimonial

    $('.done-appt-btn, .delete-appt-btn').click( function(){
        if ($(this).attr('id')){
            $("input:hidden[name=appt-id]").val($(this).attr('id'));
        }
    });


    $('#new-appts').html($('.new-appt').length);
    $('#done-appts').html($('.done-appt').length);

    $('.done-appt').parent().hide();
    $('#hide-completed').hide();

    // Show completed
    $('#show-completed').click( function(){
        $('.done-appt').parent().show();
        $(this).hide();
        $('#hide-completed').show();
    });

    // Hide completed
    $('#hide-completed').click( function(){
        $('.done-appt').parent().hide();
        $(this).hide();
        $('#show-completed').show();
    });


</script>


{% endblock js %}